(function(a){"use strict";var b=function(a,b){function c(a,b){return"object"==typeof b?(b=Object.values(b),-1<b.indexOf(a)):a&&b&&"object"!=typeof b?-1<b.indexOf(a):void 0}function d(){var a=b("body").hasClass("logged-in")?"true":"false",c=[];if(document.querySelectorAll(".tp-pro-l-type-wishlist .tp-row").length){let a=document.querySelectorAll(".tp-pro-l-type-wishlist .tp-row"),b=Array.prototype.slice.call(a);Array.prototype.push.apply(c,b)}if(document.querySelectorAll(".tp-dy-l-type-wishlist .tp-row").length){let a=document.querySelectorAll(".tp-dy-l-type-wishlist .tp-row"),b=Array.prototype.slice.call(a);Array.prototype.push.apply(c,b)}let d=[],e=[];c.length&&c.forEach(function(b,c){if(d[c]=b.dataset.wooattr?b.dataset.wooattr:[],"false"==a){var f=[];if(b.offsetParent.classList.contains("product-list")){let a=b.dataset.wid;f=JSON.parse(localStorage.getItem(a)),e[c]=f?f:[]}else if(b.offsetParent.classList.contains("dynamic-listing")){let a=b.offsetParent.dataset.wid;f=JSON.parse(localStorage.getItem(a)),e[c]=f?f:[]}}}),y("visible");var f={action:"tp_wl_get_all_data_ajax",listingtype:"wishlist",dataType:"json",option:d,login:a,notloginwl:e,security:theplus_nonce};b.ajax({type:"POST",url:theplus_ajax_url,async:!0,cache:!1,data:f,success:function(a){c.forEach(function(c,d){if(0<a.length){var e=JSON.parse(a[d].htmljsondata);if(null!=e.listdata&&0!=e.listdata.length)c.innerHTML="",c.insertAdjacentHTML("afterbegin",a[d].HtmlData),b(c).isotope("reloadItems").isotope(),y("visible"),setTimeout(function(){y("hidden")},1500);else{c.innerHTML="";var f=a[d].HtmlError?a[d].HtmlError:"Not Found";c.insertAdjacentHTML("afterbegin",`<h3 class="theplus-posts-not-found tp-pl-nf-space">${f}</h3>`)}}})}})}function e(a,b){setTimeout(function(){a.removeClass("tp-wl-loading").addClass("tp_wishlist_button").removeClass("tp_wishlist_remove").attr("title",b).text(r)},500)}function f(a){b(".tp_wishlist_button").each(function(){var d=b(this),e=d.data("product"),f=d.data("wish");e=e.toString(),c(e,a)&&(d.addClass("tp-wl-active tp_wishlist_remove").removeClass("tp_wishlist_button").attr("title",q).text(q),"tp_wl_text"==f.wishtype&&d.text("").append("<button class=\"tp_wishlist_addr\"><span class=\"tp_wish_extra\"><span style=\"opacity: 1;\">"+f.removetext+"</span></span>"),"tp_wl_icon"==f.wishtype?(d.find(".tp_wishlist_addr").remove(),d.text("").append("<button class=\"tp_wishlist_addrs\"><span style=\"opacity: 1;\"><i class=\"tp_icon_rm "+f.addicon+"\"></i></span></button>")):"tp_wl_texti"==f.wishtype&&d.text("").append("<button class=\"tp_wishlist_addr\"><span class=\"tp_wish_extra\">"+f.removetext+"</span><span style=\"opacity: 1;\"><i class=\"tp_icon_rm "+f.addicon+"\"></i></span></button>"))})}function g(a){var c=document.querySelectorAll(".tp-woo-wishlist.tp_wl_count ");c.forEach(c=>{var d=c.dataset.wid;if(a===d)if("true"==v)b.ajax({type:"POST",url:theplus_ajax_url,data:{action:"tp_wl_get_user_data",dataType:"json",status:"publish",query:w,shopname:a,security:theplus_nonce},success:function(a){if(x=JSON.parse(a),x&&x.wishlist){var b=x.count;c.querySelector(".tp-wishlist-count").textContent=b}}});else{var e=JSON.parse(localStorage.getItem(a));c.querySelector(".tp-wishlist-count").textContent="",c.querySelector(".tp-wishlist-count").textContent=e.length}})}var h=a[0].querySelectorAll(".tp-woo-wishlist"),i=a.find(".tp_wishlist_button"),j=a[0].querySelectorAll(".tp_wishlist_button"),k=i.data("wish"),l=a[0].querySelectorAll(".tp-wishlist-count"),m=h[0]?.dataset?.type?h[0].dataset.type:"";Array.prototype.unique=function(){return this.filter(function(a,b,c){return c.indexOf(a)===b})};var n=h[0].dataset.wid,o=h[0].dataset.wid,p="",q="",r="",s=[],t=sessionStorage.getItem(o),u=localStorage.getItem(n),v=b("body").hasClass("logged-in")?"true":"false",w=h[0].dataset.query,x="";(function(){setTimeout(function(){if(0<l.length)if("true"==v)b.ajax({type:"POST",url:theplus_ajax_url,data:{action:"tp_wl_get_user_data",dataType:"json",status:"publish",query:w,shopname:o,security:theplus_nonce},success:function(b){if(x=JSON.parse(b),x&&x.wishlist){var c=x.count;a[0].querySelector(".tp-wishlist-count").textContent=c}}});else{var c=JSON.parse(localStorage.getItem(n));c&&0<c.length&&(l[0].textContent="",l[0].textContent=c.length)}},500)})(),i.length&&"tp_wl_button"==k.type&&(p=k.alreadytext,q=k.removetext,r=k.addtext);var y=function(a){let b=document.querySelectorAll(".tp-skeleton");0<b.length&&b.forEach(function(b){"visible"==b.style.visibility&&1==b.style.opacity?"hidden"==a&&(b.style.cssText="visibility: hidden; opacity: 0;"):"visible"==a&&(b.style.cssText="visibility: visible; opacity: 1;")})};"true"==v?b.ajax({type:"POST",url:theplus_ajax_url,data:{action:"tp_wl_get_user_data",dataType:"json",status:"publish",query:w,shopname:o,security:theplus_nonce},success:function(a){if(x=JSON.parse(a),x&&x.wishlist){var c=x.wishlist;f(c,p),"undefined"!=typeof t&&null!=t&&t.removeItem(o)}else"undefined"!=typeof t&&null!=t&&(c=t),b.ajax({type:"POST",url:theplus_ajax_post_url,data:{action:"user_wishlist_update",user_id:x.user_id,query:w,shopname:o,wishlist:c,status:"publish",security:theplus_nonce}}).done(function(){"undefined"!=typeof t&&null!=t&&t.removeItem(o),f(c,p)})},error:function(){console.log("No user info")}}):"undefined"!=typeof u&&null!=u&&(s=u),0<j.length&&j.forEach(function(a){var f=JSON.parse(a.getAttribute("data-wish")),h=a.getAttribute("data-product");if(h=h.toString(),"false"==v&&c(h,s))if(a.classList.add("tp-wl-active"),a.setAttribute("title",p),a.classList.remove("tp_wishlist_button"),a.classList.add("tp_wishlist_remove"),a.textContent=q,"tp_wl_text"==f.wishtype){a.textContent="";var i=document.createElement("button");i.className="tp_wishlist_addr";var j=document.createElement("span");j.className="tp_wish_extra",j.textContent=f.removetext,j.style.opacity="1",i.appendChild(j),a.appendChild(i)}else if("tp_wl_icon"==f.wishtype){a.textContent="";var k=document.createElement("button");k.className="tp_wishlist_addrs";var l=document.createElement("span");l.style.opacity="1";var m=document.createElement("i");m.className="tp_icon_rm "+f.addicon,l.appendChild(m),k.appendChild(l),a.appendChild(k)}else if("tp_wl_texti"==f.wishtype){a.textContent="";var r=document.createElement("button");r.className="tp_wishlist_addr";var t=document.createElement("span");t.className="tp_wish_extra",t.textContent=f.removetext;var u=document.createElement("i");u.className="tp_icon_rm "+f.addicon;var y=document.createElement("span");y.style.opacity="1",y.appendChild(u),r.appendChild(t),r.appendChild(y),a.appendChild(r)}a.addEventListener("click",function(c){if(c.preventDefault(),!a.classList.contains("tp-wl-active")&&!a.classList.contains("tp-wl-loading")){if(a.classList.add("tp_wishlist_button"),a.classList.add("tp-wl-loading"),"tp_wl_text"==f.wishtype){a.textContent="";var e=document.createElement("button");e.className="tp_wishlist_addrs";var i=document.createElement("span");i.className="tp_wish_extra";var j=document.createElement("span");j.style.opacity="0",j.textContent=f.addtext;var k=document.createElement("div");k.className="tp-wl-button-loading",i.appendChild(j),e.appendChild(i),e.appendChild(k),a.appendChild(e)}else if("tp_wl_icon"==f.wishtype){a.textContent="";var l=document.createElement("button");l.className="tp_wishlist_addrs";var m=document.createElement("span");m.style.opacity="0";var r=document.createElement("i");r.className="tp_icon_rm "+f.addicon;var k=document.createElement("div");k.className="tp-wl-button-loading",m.appendChild(r),l.appendChild(m),l.appendChild(k),a.appendChild(l)}else if("tp_wl_texti"==f.wishtype){a.textContent="";var t=document.createElement("button");t.className="tp_wishlist_addr";var i=document.createElement("span");i.className="tp_wish_extra",i.textContent=f.addtext;var j=document.createElement("span");j.style.opacity="0";var u=document.createElement("i");u.className="tp_icon_rm "+f.removeicon;var k=document.createElement("div");k.className="tp-wl-button-loading",k.style.left="auto;",j.appendChild(u),t.appendChild(i),t.appendChild(j),t.appendChild(k),a.appendChild(t)}if("true"==v)x.user_id&&b.ajax({type:"POST",url:theplus_ajax_post_url,data:{action:"user_wishlist_update",user_id:x.user_id,query:w,shopname:o,wishlist:h,status:"publish",security:theplus_nonce}}).done(function(){if(a.classList.remove("tp-wl-loading"),a.classList.add("tp-wl-active"),a.classList.add("tp_wishlist_remove"),a.classList.remove("tp_wishlist_button"),a.setAttribute("title",p),a.textContent=q,d(),g(o),a.classList.remove("tp-wl-button-loading"),"tp_wl_text"==f.wishtype)setTimeout(function(){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addrs";var c=document.createElement("span");c.className="tp_wish_extra";var d=document.createElement("span");d.style.opacity="1",d.textContent=f.removetext,c.appendChild(d),b.appendChild(c),a.appendChild(b)},500);else if("tp_wl_icon"==f.wishtype)setTimeout(function(){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addrs";var c=document.createElement("span");c.style.opacity="1";var d=document.createElement("i");d.className="tp_icon_rm "+f.addicon,c.appendChild(d),b.appendChild(c),a.appendChild(b)},500);else if("tp_wl_texti"==f.wishtype){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addr";var c=document.createElement("span");c.className="tp_wish_extra",c.textContent=f.addtext;var e=document.createElement("span");e.style.opacity="0";var h=document.createElement("i");h.className="tp_icon_rm "+f.removeicon;var i=document.createElement("div");i.className="tp-wl-button-loading",i.style.left="auto",e.appendChild(h),b.appendChild(c),b.appendChild(e),b.appendChild(i),a.appendChild(b),setTimeout(function(){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addr";var c=document.createElement("span");c.className="tp_wish_extra",c.textContent=f.removetext;var d=document.createElement("span");d.style.opacity="1";var e=document.createElement("i");e.className="tp_icon_rm "+f.addicon,d.appendChild(e),b.appendChild(c),b.appendChild(d),a.appendChild(b)},500)}}).fail(function(){if(alert("Something went wrong"),a.classList.remove("tp-wl-button-loading"),a.textContent=q,"tp_wl_icon"==f.wishtype){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addrs";var c=document.createElement("i");c.className="tp_icon_rm "+f.addicon,b.appendChild(c),a.appendChild(b)}});else{if(s=JSON.parse(localStorage.getItem(n)),null==s&&(s=[]),s.push(h),s=s.unique(),localStorage.setItem(n,JSON.stringify(s)),a.classList.remove("tp-wl-loading"),a.classList.add("tp-wl-active"),a.classList.add("tp_wishlist_remove"),a.classList.remove("tp_wishlist_button"),a.setAttribute("title",p),a.textContent=q,d(),g(n),"tp_wl_text"==f.wishtype){a.textContent="";var e=document.createElement("button");e.className="tp_wishlist_addrs";var i=document.createElement("span");i.className="tp_wish_extra";var j=document.createElement("span");j.style.opacity="0",j.textContent=f.addtext;var k=document.createElement("div");k.className="tp-wl-button-loading",i.appendChild(j),e.appendChild(i),e.appendChild(k),a.appendChild(e),setTimeout(function(){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addrs";var c=document.createElement("span");c.className="tp_wish_extra";var d=document.createElement("span");d.style.opacity="1",d.textContent=f.removetext,c.appendChild(d),b.appendChild(c),a.appendChild(b)},500)}else if("tp_wl_icon"==f.wishtype){a.textContent="";var l=document.createElement("button");l.className="tp_wishlist_addrs";var m=document.createElement("span");m.style.opacity="0";var r=document.createElement("i");r.className="tp_icon_rm "+f.addicon;var k=document.createElement("div");k.className="tp-wl-button-loading",m.appendChild(r),l.appendChild(m),l.appendChild(k),a.appendChild(l),setTimeout(function(){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addrs";var c=document.createElement("span");c.style.opacity="1";var d=document.createElement("i");d.className="tp_icon_rm "+f.addicon,c.appendChild(d),b.appendChild(c),a.appendChild(b)},500)}else if("tp_wl_texti"==f.wishtype){a.textContent="";var t=document.createElement("button");t.className="tp_wishlist_addr";var i=document.createElement("span");i.className="tp_wish_extra",i.textContent=f.addtext;var j=document.createElement("span");j.style.opacity="0";var u=document.createElement("i");u.className="tp_icon_rm "+f.removeicon;var k=document.createElement("div");k.className="tp-wl-button-loading",k.style.left="auto",j.appendChild(u),t.appendChild(i),t.appendChild(j),t.appendChild(k),a.appendChild(t),setTimeout(function(){a.textContent="";var b=document.createElement("button");b.className="tp_wishlist_addr";var c=document.createElement("span");c.className="tp_wish_extra",c.textContent=f.removetext;var d=document.createElement("span");d.style.opacity="1";var e=document.createElement("i");e.className="tp_icon_rm "+f.addicon,d.appendChild(e),b.appendChild(c),b.appendChild(d),a.appendChild(b)},500)}c.stopImmediatePropagation()}}})}),b(h[0]).on("click",".tp_wishlist_remove",function(a){a.preventDefault();var c=b(this),f=c.data("product"),h=c.data("wish");f=f.toString();var i=JSON.parse(f);if(c.removeClass("tp-wl-active").attr("title",r),c.addClass("tp_wishlist_button"),"tp_wl_text"==h.wishtype?setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addrs\"><span class=\"tp_wish_extra\"><span style=\"opacity: 0;\">"+h.removetext+"</span></span><div class=\"tp-wl-button-loading\"></div></button>")},500):"tp_wl_texti"==h.wishtype?setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addr\"><span class=\"tp_wish_extra\">"+h.removetext+"</span><span style=\"opacity: 0;\"><i class=\"tp_icon_rm "+h.removeicon+"\"></i></span><div class=\"tp-wl-button-loading\" style=\"left: auto;\"></div></button>")},500):"tp_wl_icon"==h.wishtype&&setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addrs\"><span style=\"opacity: 0;\"><i class=\"tp_icon_rm "+h.addicon+"\"></i></span><div class=\"tp-wl-button-loading\"></div></button>")},500),!c.hasClass("tp-wl-active")&&!c.hasClass("tp-wl-loading")){if("true"==v)c.addClass("tp-wl-loading"),x.user_id&&b.ajax({type:"POST",url:theplus_ajax_post_url,data:{action:"tp_user_wishlist_remove",user_id:x.user_id,query:w,shopname:o,wishlist:i,status:"publish",security:theplus_nonce}}).done(function(){e(c,r),d(),g(o),c.removeClass("tp-wl-button-loading"),"tp_wl_text"==h.wishtype?setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addrs\"><span class=\"tp_wish_extra\"><span style=\"opacity: 1;\">"+h.addtext+"</span></span></button>")},500):"tp_wl_icon"==h.wishtype?setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addrs\"><span style=\"opacity: 1;\"><i class=\"tp_icon_rm "+h.removeicon+"\"></i></span></button>")},500):"tp_wl_texti"==h.wishtype&&setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addr\"><span class=\"tp_wish_extra\">"+h.addtext+"</span><i class=\"tp_icon_rm "+h.removeicon+"\"></i></button>")},500)}).fail(function(){alert("Something went wrong"),c.text(r).removeClass("tp-wl-button-loading"),"tp_wl_icon"==h.wishtype&&c.append("<button class=\"tp_wishlist_addrs\"><i class=\"tp_icon_rm "+h.removeicon+"\"></i></button>")});else{var j=JSON.parse(localStorage.getItem(n)),k=jQuery.grep(j,function(a){return a!=f});localStorage.setItem(n,JSON.stringify(k)),e(c,r),d(),g(n),"tp_wl_text"==h.wishtype?(c.text("").append("<button class=\"tp_wishlist_addrs\"><span class=\"tp_wish_extra\"><span style=\"opacity: 0;\">"+h.removetext+"</span></span><div class=\"tp-wl-button-loading\"></div></button>"),setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addrs\"><span class=\"tp_wish_extra\"><span style=\"opacity: 1;\">"+h.addtext+"</span></span></button>")},500)):"tp_wl_icon"==h.wishtype?(c.text("").append("<button class=\"tp_wishlist_addrs\"><span style=\"opacity: 0;\"><i class=\"tp_icon_rm "+h.addicon+"\"></i></span><div class=\"tp-wl-button-loading\"></div></button>"),setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addrs\"><span style=\"opacity: 1;\"><i class=\"tp_icon_rm "+h.removeicon+"\"></i></span></button>")},500)):"tp_wl_texti"==h.wishtype&&(c.text("").append("<button class=\"tp_wishlist_addr\"><span class=\"tp_wish_extra\">"+h.removetext+"</span><span style=\"opacity: 0;\"><i class=\"tp_icon_rm "+h.addicon+"\"></i></span><div class=\"tp-wl-button-loading\" style=\"left: auto;\"></div></button>"),setTimeout(function(){c.text("").append("<button class=\"tp_wishlist_addr\"><span class=\"tp_wish_extra\">"+h.addtext+"</span><span style=\"opacity: 1;\"><i class=\"tp_icon_rm "+h.removeicon+"\"></i></span></button>")},500))}a.stopImmediatePropagation()}})};a(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/tp-woo-wishlist.default",b)})})(jQuery);